우리 아키텍처에서 Redis를 마스터 3대 + 슬레이브 3대로 구성한 이유는 크게 네 가지로 정리할 수 있습니다:

1. 성능(쓰기 부하 분산)

    Redis Cluster 모드에서 데이터를 키 범위(slot)로 샤딩합니다.

    3개의 마스터가 stream_id 범위(033%, 3466%, 67~100%)를 나눠서 저장하므로,
    단일 노드에 쓰기 부하가 몰리지 않고 입·퇴장 시청자 카운트 업데이트를 병렬 처리할 수 있습니다.

    피크타임 기준 초당 6,600건 이상의 입·퇴장 요청을 마스터 3대가 분산 처리합니다.

2. 고가용성(HA)

    각 마스터에 대응하는 슬레이브가 다른 AZ에 배치됩니다.

    마스터 장애 시 Redis Sentinel이 해당 슬레이브를 30초 이내에 자동 승격하여 서비스 중단을 최소화합니다.

    AZ 단위 장애에도 데이터를 잃지 않고 즉시 페일오버 가능.


3. 읽기 부하 분산

    실시간 시청자수 조회는 대부분 읽기 요청이므로, 읽기는 슬레이브에서 처리할 수 있게 구성했습니다.

    인기 방송의 경우 조회 요청이 초당 수천 건 이상 발생하므로, 슬레이브로 읽기를 분산하면 마스터 쓰기 성능 저하를 방지할 수 있습니다.


4. 장애 도메인 분리 및 확장성

    3개 AZ에 마스터·슬레이브를 번갈아 배치해, 한 AZ 장애 시에도 전체 클러스터의 2/3 이상이 정상 동작.

    향후 트래픽이 늘어나면 마스터-슬레이브 쌍을 추가해 수평 확장이 가능.

즉, 마스터 3대는 쓰기/샤딩, 슬레이브 3대는 읽기 부하 분산 및 장애 대비라는 역할 분담을 통해
100만 동시접속 환경에서의 성능, 안정성, 확장성을 모두 만족시키는 구조입니다.